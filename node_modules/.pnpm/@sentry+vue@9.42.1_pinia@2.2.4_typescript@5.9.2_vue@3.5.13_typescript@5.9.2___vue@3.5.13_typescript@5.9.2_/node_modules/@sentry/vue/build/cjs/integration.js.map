{"version":3,"file":"integration.js","sources":["../../src/integration.ts"],"sourcesContent":["import { consoleSandbox, defineIntegration, GLOBAL_OBJ, hasSpansEnabled } from '@sentry/core';\nimport { DEFAULT_HOOKS } from './constants';\nimport { DEBUG_BUILD } from './debug-build';\nimport { attachErrorHandler } from './errorhandler';\nimport { createTracingMixins } from './tracing';\nimport type { Options, Vue, VueOptions } from './types';\n\nconst globalWithVue = GLOBAL_OBJ as typeof GLOBAL_OBJ & { Vue: Vue };\n\nconst DEFAULT_CONFIG: VueOptions = {\n  Vue: globalWithVue.Vue,\n  attachProps: true,\n  attachErrorHandler: true,\n  tracingOptions: {\n    hooks: DEFAULT_HOOKS,\n    timeout: 2000,\n    trackComponents: false,\n  },\n};\n\nconst INTEGRATION_NAME = 'Vue';\n\nexport type VueIntegrationOptions = Partial<VueOptions>;\n\nexport const vueIntegration = defineIntegration((integrationOptions: Partial<VueOptions> = {}) => {\n  return {\n    name: INTEGRATION_NAME,\n    setup(client) {\n      const options: Options = { ...DEFAULT_CONFIG, ...client.getOptions(), ...integrationOptions };\n      if (!options.Vue && !options.app) {\n        consoleSandbox(() => {\n          // eslint-disable-next-line no-console\n          console.warn(\n            '[@sentry/vue]: Misconfigured SDK. Vue specific errors will not be captured. Update your `Sentry.init` call with an appropriate config option: `app` (Application Instance - Vue 3) or `Vue` (Vue Constructor - Vue 2).',\n          );\n        });\n        return;\n      }\n\n      if (options.app) {\n        const apps = Array.isArray(options.app) ? options.app : [options.app];\n        apps.forEach(app => vueInit(app, options));\n      } else if (options.Vue) {\n        vueInit(options.Vue, options);\n      }\n    },\n  };\n});\n\nconst vueInit = (app: Vue, options: Options): void => {\n  if (DEBUG_BUILD) {\n    // Check app is not mounted yet - should be mounted _after_ init()!\n    // This is _somewhat_ private, but in the case that this doesn't exist we simply ignore it\n    // See: https://github.com/vuejs/core/blob/eb2a83283caa9de0a45881d860a3cbd9d0bdd279/packages/runtime-core/src/component.ts#L394\n    const appWithInstance = app as Vue & {\n      _instance?: {\n        isMounted?: boolean;\n      };\n    };\n\n    const isMounted = appWithInstance._instance?.isMounted;\n    if (isMounted === true) {\n      consoleSandbox(() => {\n        // eslint-disable-next-line no-console\n        console.warn(\n          '[@sentry/vue]: Misconfigured SDK. Vue app is already mounted. Make sure to call `app.mount()` after `Sentry.init()`.',\n        );\n      });\n    }\n  }\n\n  if (options.attachErrorHandler) {\n    attachErrorHandler(app, options);\n  }\n\n  if (hasSpansEnabled(options)) {\n    app.mixin(createTracingMixins(options.tracingOptions));\n  }\n};\n"],"names":["GLOBAL_OBJ","DEFAULT_HOOKS","defineIntegration","consoleSandbox","DEBUG_BUILD","attachErrorHandler","hasSpansEnabled","createTracingMixins"],"mappings":";;;;;;;;AAOA,MAAM,aAAA,GAAgBA,eAAA;;AAEtB,MAAM,cAAc,GAAe;AACnC,EAAE,GAAG,EAAE,aAAa,CAAC,GAAG;AACxB,EAAE,WAAW,EAAE,IAAI;AACnB,EAAE,kBAAkB,EAAE,IAAI;AAC1B,EAAE,cAAc,EAAE;AAClB,IAAI,KAAK,EAAEC,uBAAa;AACxB,IAAI,OAAO,EAAE,IAAI;AACjB,IAAI,eAAe,EAAE,KAAK;AAC1B,GAAG;AACH,CAAC;;AAED,MAAM,gBAAA,GAAmB,KAAK;;AAIvB,MAAM,cAAA,GAAiBC,sBAAiB,CAAC,CAAC,kBAAkB,GAAwB,EAAE,KAAK;AAClG,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,gBAAgB;AAC1B,IAAI,KAAK,CAAC,MAAM,EAAE;AAClB,MAAM,MAAM,OAAO,GAAY,EAAE,GAAG,cAAc,EAAE,GAAG,MAAM,CAAC,UAAU,EAAE,EAAE,GAAG,oBAAoB;AACnG,MAAM,IAAI,CAAC,OAAO,CAAC,GAAA,IAAO,CAAC,OAAO,CAAC,GAAG,EAAE;AACxC,QAAQC,mBAAc,CAAC,MAAM;AAC7B;AACA,UAAU,OAAO,CAAC,IAAI;AACtB,YAAY,wNAAwN;AACpO,WAAW;AACX,SAAS,CAAC;AACV,QAAQ;AACR;;AAEA,MAAM,IAAI,OAAO,CAAC,GAAG,EAAE;AACvB,QAAQ,MAAM,OAAO,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,IAAI,OAAO,CAAC,GAAA,GAAM,CAAC,OAAO,CAAC,GAAG,CAAC;AAC7E,QAAQ,IAAI,CAAC,OAAO,CAAC,GAAA,IAAO,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;AAClD,aAAa,IAAI,OAAO,CAAC,GAAG,EAAE;AAC9B,QAAQ,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC;AACrC;AACA,KAAK;AACL,GAAG;AACH,CAAC;;AAED,MAAM,UAAU,CAAC,GAAG,EAAO,OAAO,KAAoB;AACtD,EAAE,IAAIC,sBAAW,EAAE;AACnB;AACA;AACA;AACA,IAAI,MAAM,eAAA,GAAkB;;AAIxB;;AAEJ,IAAI,MAAM,SAAA,GAAY,eAAe,CAAC,SAAS,EAAE,SAAS;AAC1D,IAAI,IAAI,SAAA,KAAc,IAAI,EAAE;AAC5B,MAAMD,mBAAc,CAAC,MAAM;AAC3B;AACA,QAAQ,OAAO,CAAC,IAAI;AACpB,UAAU,sHAAsH;AAChI,SAAS;AACT,OAAO,CAAC;AACR;AACA;;AAEA,EAAE,IAAI,OAAO,CAAC,kBAAkB,EAAE;AAClC,IAAIE,+BAAkB,CAAC,GAAG,EAAE,OAAO,CAAC;AACpC;;AAEA,EAAE,IAAIC,oBAAe,CAAC,OAAO,CAAC,EAAE;AAChC,IAAI,GAAG,CAAC,KAAK,CAACC,2BAAmB,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;AAC1D;AACA,CAAC;;;;"}