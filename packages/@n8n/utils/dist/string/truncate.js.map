{"version":3,"sources":["../../src/string/truncate.ts"],"sourcesContent":["export const truncate = (text: string, length = 30): string =>\n\ttext.length > length ? text.slice(0, length) + '...' : text;\n\n/**\n * Replace part of given text with ellipsis following the rules below:\n *\n * - Remove chars just before the last word, as long as the last word is under 15 chars\n * - Otherwise preserve the last 5 chars of the name and remove chars before that\n */\nexport function truncateBeforeLast(text: string, maxLength: number): string {\n\tconst chars: string[] = [];\n\n\tconst segmenter = new Intl.Segmenter(undefined, { granularity: 'grapheme' });\n\n\tfor (const { segment } of segmenter.segment(text)) {\n\t\tchars.push(segment);\n\t}\n\n\tif (chars.length <= maxLength) {\n\t\treturn text;\n\t}\n\n\tconst lastWhitespaceIndex = chars.findLastIndex((ch) => ch.match(/^\\s+$/));\n\tconst lastWordIndex = lastWhitespaceIndex + 1;\n\tconst lastWord = chars.slice(lastWordIndex);\n\tconst ellipsis = 'â€¦';\n\tconst ellipsisLength = ellipsis.length;\n\n\tif (lastWord.length < 15) {\n\t\tconst charsToRemove = chars.length - maxLength + ellipsisLength;\n\t\tconst indexBeforeLastWord = lastWordIndex;\n\t\tconst keepLength = indexBeforeLastWord - charsToRemove;\n\n\t\tif (keepLength > 0) {\n\t\t\treturn (\n\t\t\t\tchars.slice(0, keepLength).join('') + ellipsis + chars.slice(indexBeforeLastWord).join('')\n\t\t\t);\n\t\t}\n\t}\n\n\treturn (\n\t\tchars.slice(0, maxLength - 5 - ellipsisLength).join('') + ellipsis + chars.slice(-5).join('')\n\t);\n}\n"],"mappings":";AAAO,IAAM,WAAW,CAAC,MAAc,SAAS,OAC/C,KAAK,SAAS,SAAS,KAAK,MAAM,GAAG,MAAM,IAAI,QAAQ;AAQjD,SAAS,mBAAmB,MAAc,WAA2B;AAC3E,QAAM,QAAkB,CAAC;AAEzB,QAAM,YAAY,IAAI,KAAK,UAAU,QAAW,EAAE,aAAa,WAAW,CAAC;AAE3E,aAAW,EAAE,QAAQ,KAAK,UAAU,QAAQ,IAAI,GAAG;AAClD,UAAM,KAAK,OAAO;AAAA,EACnB;AAEA,MAAI,MAAM,UAAU,WAAW;AAC9B,WAAO;AAAA,EACR;AAEA,QAAM,sBAAsB,MAAM,cAAc,CAAC,OAAO,GAAG,MAAM,OAAO,CAAC;AACzE,QAAM,gBAAgB,sBAAsB;AAC5C,QAAM,WAAW,MAAM,MAAM,aAAa;AAC1C,QAAM,WAAW;AACjB,QAAM,iBAAiB,SAAS;AAEhC,MAAI,SAAS,SAAS,IAAI;AACzB,UAAM,gBAAgB,MAAM,SAAS,YAAY;AACjD,UAAM,sBAAsB;AAC5B,UAAM,aAAa,sBAAsB;AAEzC,QAAI,aAAa,GAAG;AACnB,aACC,MAAM,MAAM,GAAG,UAAU,EAAE,KAAK,EAAE,IAAI,WAAW,MAAM,MAAM,mBAAmB,EAAE,KAAK,EAAE;AAAA,IAE3F;AAAA,EACD;AAEA,SACC,MAAM,MAAM,GAAG,YAAY,IAAI,cAAc,EAAE,KAAK,EAAE,IAAI,WAAW,MAAM,MAAM,EAAE,EAAE,KAAK,EAAE;AAE9F;","names":[]}