{"version":3,"sources":["../src/api/users.ts"],"sourcesContent":["import type {\n\tLoginRequestDto,\n\tPasswordUpdateRequestDto,\n\tSettingsUpdateRequestDto,\n\tUsersListFilterDto,\n\tUserUpdateRequestDto,\n\tRole,\n\tUsersList,\n\tUser,\n} from '@n8n/api-types';\nimport type { Scope } from '@n8n/permissions';\nimport type {\n\tFeatureFlags,\n\tIDataObject,\n\tIPersonalizationSurveyAnswersV4,\n\tIUserSettings,\n} from 'n8n-workflow';\n\nimport type { IRestApiContext } from '../types';\nimport { makeRestApiRequest } from '../utils';\n\nexport type IPersonalizationSurveyAnswersV1 = {\n\tcodingSkill?: string | null;\n\tcompanyIndustry?: string[] | null;\n\tcompanySize?: string | null;\n\totherCompanyIndustry?: string | null;\n\totherWorkArea?: string | null;\n\tworkArea?: string[] | string | null;\n};\n\nexport type IPersonalizationSurveyAnswersV2 = {\n\tversion: 'v2';\n\tautomationGoal?: string | null;\n\tcodingSkill?: string | null;\n\tcompanyIndustryExtended?: string[] | null;\n\tcompanySize?: string | null;\n\tcompanyType?: string | null;\n\tcustomerType?: string | null;\n\tmspFocus?: string[] | null;\n\tmspFocusOther?: string | null;\n\totherAutomationGoal?: string | null;\n\totherCompanyIndustryExtended?: string[] | null;\n};\n\nexport type IPersonalizationSurveyAnswersV3 = {\n\tversion: 'v3';\n\tautomationGoal?: string | null;\n\totherAutomationGoal?: string | null;\n\tcompanyIndustryExtended?: string[] | null;\n\totherCompanyIndustryExtended?: string[] | null;\n\tcompanySize?: string | null;\n\tcompanyType?: string | null;\n\tautomationGoalSm?: string[] | null;\n\tautomationGoalSmOther?: string | null;\n\tusageModes?: string[] | null;\n\temail?: string | null;\n};\n\nexport type IPersonalizationLatestVersion = IPersonalizationSurveyAnswersV4;\n\nexport type IPersonalizationSurveyVersions =\n\t| IPersonalizationSurveyAnswersV1\n\t| IPersonalizationSurveyAnswersV2\n\t| IPersonalizationSurveyAnswersV3\n\t| IPersonalizationSurveyAnswersV4;\n\nexport interface IUserResponse extends User {\n\tglobalScopes?: Scope[];\n\tpersonalizationAnswers?: IPersonalizationSurveyVersions | null;\n\tsettings?: IUserSettings | null;\n}\n\nexport interface CurrentUserResponse extends IUserResponse {\n\tfeatureFlags?: FeatureFlags;\n}\n\nexport interface IUser extends IUserResponse {\n\tisDefaultUser: boolean;\n\tisPendingUser: boolean;\n\tinviteAcceptUrl?: string;\n\tfullName?: string;\n\tcreatedAt?: string;\n\tmfaEnabled: boolean;\n\tmfaAuthenticated?: boolean;\n}\n\nexport async function loginCurrentUser(\n\tcontext: IRestApiContext,\n): Promise<CurrentUserResponse | null> {\n\treturn await makeRestApiRequest(context, 'GET', '/login');\n}\n\nexport async function login(\n\tcontext: IRestApiContext,\n\tparams: LoginRequestDto,\n): Promise<CurrentUserResponse> {\n\treturn await makeRestApiRequest(context, 'POST', '/login', params);\n}\n\nexport async function logout(context: IRestApiContext): Promise<void> {\n\tawait makeRestApiRequest(context, 'POST', '/logout');\n}\n\nexport async function setupOwner(\n\tcontext: IRestApiContext,\n\tparams: { firstName: string; lastName: string; email: string; password: string },\n): Promise<CurrentUserResponse> {\n\treturn await makeRestApiRequest(\n\t\tcontext,\n\t\t'POST',\n\t\t'/owner/setup',\n\t\tparams as unknown as IDataObject,\n\t);\n}\n\nexport async function validateSignupToken(\n\tcontext: IRestApiContext,\n\tparams: { inviterId: string; inviteeId: string },\n): Promise<{ inviter: { firstName: string; lastName: string } }> {\n\treturn await makeRestApiRequest(context, 'GET', '/resolve-signup-token', params);\n}\n\nexport async function signup(\n\tcontext: IRestApiContext,\n\tparams: {\n\t\tinviterId: string;\n\t\tinviteeId: string;\n\t\tfirstName: string;\n\t\tlastName: string;\n\t\tpassword: string;\n\t},\n): Promise<CurrentUserResponse> {\n\tconst { inviteeId, ...props } = params;\n\treturn await makeRestApiRequest(\n\t\tcontext,\n\t\t'POST',\n\t\t`/users/${params.inviteeId}`,\n\t\tprops as unknown as IDataObject,\n\t);\n}\n\nexport async function sendForgotPasswordEmail(\n\tcontext: IRestApiContext,\n\tparams: { email: string },\n): Promise<void> {\n\tawait makeRestApiRequest(context, 'POST', '/forgot-password', params);\n}\n\nexport async function validatePasswordToken(\n\tcontext: IRestApiContext,\n\tparams: { token: string },\n): Promise<void> {\n\tawait makeRestApiRequest(context, 'GET', '/resolve-password-token', params);\n}\n\nexport async function changePassword(\n\tcontext: IRestApiContext,\n\tparams: { token: string; password: string; mfaCode?: string },\n): Promise<void> {\n\tawait makeRestApiRequest(context, 'POST', '/change-password', params);\n}\n\nexport async function updateCurrentUser(\n\tcontext: IRestApiContext,\n\tparams: UserUpdateRequestDto,\n): Promise<IUserResponse> {\n\treturn await makeRestApiRequest(context, 'PATCH', '/me', params);\n}\n\nexport async function updateCurrentUserSettings(\n\tcontext: IRestApiContext,\n\tsettings: SettingsUpdateRequestDto,\n): Promise<IUserSettings> {\n\treturn await makeRestApiRequest(context, 'PATCH', '/me/settings', settings);\n}\n\nexport async function updateOtherUserSettings(\n\tcontext: IRestApiContext,\n\tuserId: string,\n\tsettings: SettingsUpdateRequestDto,\n): Promise<IUserSettings> {\n\treturn await makeRestApiRequest(context, 'PATCH', `/users/${userId}/settings`, settings);\n}\n\nexport async function updateCurrentUserPassword(\n\tcontext: IRestApiContext,\n\tparams: PasswordUpdateRequestDto,\n): Promise<void> {\n\treturn await makeRestApiRequest(context, 'PATCH', '/me/password', params);\n}\n\nexport async function deleteUser(\n\tcontext: IRestApiContext,\n\t{ id, transferId }: { id: string; transferId?: string },\n): Promise<void> {\n\tawait makeRestApiRequest(context, 'DELETE', `/users/${id}`, transferId ? { transferId } : {});\n}\n\nexport async function getUsers(\n\tcontext: IRestApiContext,\n\tfilter?: UsersListFilterDto,\n): Promise<UsersList> {\n\treturn await makeRestApiRequest(context, 'GET', '/users', filter);\n}\n\nexport async function getInviteLink(\n\tcontext: IRestApiContext,\n\t{ id }: { id: string },\n): Promise<{ link: string }> {\n\treturn await makeRestApiRequest(context, 'GET', `/users/${id}/invite-link`);\n}\n\nexport async function getPasswordResetLink(\n\tcontext: IRestApiContext,\n\t{ id }: { id: string },\n): Promise<{ link: string }> {\n\treturn await makeRestApiRequest(context, 'GET', `/users/${id}/password-reset-link`);\n}\n\nexport async function submitPersonalizationSurvey(\n\tcontext: IRestApiContext,\n\tparams: IPersonalizationLatestVersion,\n): Promise<void> {\n\tawait makeRestApiRequest(context, 'POST', '/me/survey', params as unknown as IDataObject);\n}\n\nexport interface UpdateGlobalRolePayload {\n\tid: string;\n\tnewRoleName: Role;\n}\n\nexport async function updateGlobalRole(\n\tcontext: IRestApiContext,\n\t{ id, newRoleName }: UpdateGlobalRolePayload,\n): Promise<IUserResponse> {\n\treturn await makeRestApiRequest(context, 'PATCH', `/users/${id}/role`, { newRoleName });\n}\n"],"mappings":";;;;;AAsFA,eAAsB,iBACrB,SACsC;AACtC,SAAO,MAAM,mBAAmB,SAAS,OAAO,QAAQ;AACzD;AAEA,eAAsB,MACrB,SACA,QAC+B;AAC/B,SAAO,MAAM,mBAAmB,SAAS,QAAQ,UAAU,MAAM;AAClE;AAEA,eAAsB,OAAO,SAAyC;AACrE,QAAM,mBAAmB,SAAS,QAAQ,SAAS;AACpD;AAEA,eAAsB,WACrB,SACA,QAC+B;AAC/B,SAAO,MAAM;AAAA,IACZ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD;AACD;AAEA,eAAsB,oBACrB,SACA,QACgE;AAChE,SAAO,MAAM,mBAAmB,SAAS,OAAO,yBAAyB,MAAM;AAChF;AAEA,eAAsB,OACrB,SACA,QAO+B;AAC/B,QAAM,EAAE,WAAW,GAAG,MAAM,IAAI;AAChC,SAAO,MAAM;AAAA,IACZ;AAAA,IACA;AAAA,IACA,UAAU,OAAO,SAAS;AAAA,IAC1B;AAAA,EACD;AACD;AAEA,eAAsB,wBACrB,SACA,QACgB;AAChB,QAAM,mBAAmB,SAAS,QAAQ,oBAAoB,MAAM;AACrE;AAEA,eAAsB,sBACrB,SACA,QACgB;AAChB,QAAM,mBAAmB,SAAS,OAAO,2BAA2B,MAAM;AAC3E;AAEA,eAAsB,eACrB,SACA,QACgB;AAChB,QAAM,mBAAmB,SAAS,QAAQ,oBAAoB,MAAM;AACrE;AAEA,eAAsB,kBACrB,SACA,QACyB;AACzB,SAAO,MAAM,mBAAmB,SAAS,SAAS,OAAO,MAAM;AAChE;AAEA,eAAsB,0BACrB,SACA,UACyB;AACzB,SAAO,MAAM,mBAAmB,SAAS,SAAS,gBAAgB,QAAQ;AAC3E;AAEA,eAAsB,wBACrB,SACA,QACA,UACyB;AACzB,SAAO,MAAM,mBAAmB,SAAS,SAAS,UAAU,MAAM,aAAa,QAAQ;AACxF;AAEA,eAAsB,0BACrB,SACA,QACgB;AAChB,SAAO,MAAM,mBAAmB,SAAS,SAAS,gBAAgB,MAAM;AACzE;AAEA,eAAsB,WACrB,SACA,EAAE,IAAI,WAAW,GACD;AAChB,QAAM,mBAAmB,SAAS,UAAU,UAAU,EAAE,IAAI,aAAa,EAAE,WAAW,IAAI,CAAC,CAAC;AAC7F;AAEA,eAAsB,SACrB,SACA,QACqB;AACrB,SAAO,MAAM,mBAAmB,SAAS,OAAO,UAAU,MAAM;AACjE;AAEA,eAAsB,cACrB,SACA,EAAE,GAAG,GACuB;AAC5B,SAAO,MAAM,mBAAmB,SAAS,OAAO,UAAU,EAAE,cAAc;AAC3E;AAEA,eAAsB,qBACrB,SACA,EAAE,GAAG,GACuB;AAC5B,SAAO,MAAM,mBAAmB,SAAS,OAAO,UAAU,EAAE,sBAAsB;AACnF;AAEA,eAAsB,4BACrB,SACA,QACgB;AAChB,QAAM,mBAAmB,SAAS,QAAQ,cAAc,MAAgC;AACzF;AAOA,eAAsB,iBACrB,SACA,EAAE,IAAI,YAAY,GACO;AACzB,SAAO,MAAM,mBAAmB,SAAS,SAAS,UAAU,EAAE,SAAS,EAAE,YAAY,CAAC;AACvF;","names":[]}